# WHO data from git-repository
coviddata_who_all = pd.read_csv(
    os.environ['HOME'] +
    "/covid19/COVID-19/who_covid_19_situation_reports/who_covid_19_sit_rep_time_series/who_covid_19_sit_rep_time_series.csv",
    sep=',',
)


def coviddata_who_countries(countries):
    """
    Dataframe with columns countries and date=-index input from WHO data
    """

    # Drop non-dates
    coviddata_who_countries = coviddata_who_all.drop(
        ["Province/States", "Country/Region", "WHO region"], axis=1)

    # Drop unnamed
    coviddata_who_countries = coviddata_who_countries.drop(
        coviddata_who_countries.columns[
            coviddata_who_countries.columns.str.contains("^Unnamed")],
        axis=1)

    # Transpose
    coviddata_who_countries = coviddata_who_countries.T

    # Index to datetime
    coviddata_who_countries.index = pd.to_datetime(
        coviddata_who_countries.index)

    # Column names to countrynames
    coviddata_who_countries.columns = coviddata_who_all["Country/Region"]

    # Countries
    coviddata_who_countries = coviddata_who_countries[countries]

    if "China" in countries:
        covid_france = coviddata_who_countries["China"].sum(axis="columns")
        coviddata_who_countries = coviddata_who_countries.drop("China",
                                                               axis="columns")
        coviddata_who_countries["China"] = covid_france

    return coviddata_who_countries
