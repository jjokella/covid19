import os
import numpy as np
import pandas as pd
import covidfuncs.dffuncs as cvdff

# Population
population = {
    "Germany": 83.80,  #
    "Italy": 60.50,  #
    "France": 65.20,  #
    "Belgium": 11.60,  #
    "Spain": 46.80,  #
    "Netherlands": 17.10,  #
    "US": 329.40,  #
    "Korea, South": 51.80,  #
    "Sweden": 10.33, #
    "United Kingdom": 66.43, #
    "Poland": 38.38, #
}

# CSSE John Hopkins University, git-repository
coviddata_csse_confirmed = pd.read_csv(
    os.environ['HOME'] +
    "/covid19/COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv",
    sep=',',
)
coviddata_csse_deaths = pd.read_csv(
    os.environ['HOME'] +
    "/covid19/COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Deaths.csv",
    sep=',',
)

coviddata_csse_recovered = pd.read_csv(
    os.environ['HOME'] +
    "/covid19/COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Recovered.csv",
    sep=',',
)


def coviddata_csse(countries, switch=None):
    """
    Dataframe with columns countries and date=-index input from CSSE data
    """

    coviddata_csse_current = (coviddata_csse_deaths if switch == "Deaths" else
                              (coviddata_csse_recovered if switch ==
                               "Recovered" else coviddata_csse_confirmed))

    # Drop non-dates
    coviddata_csse = coviddata_csse_current.drop(
        ["Province/State", "Country/Region", "Lat", "Long"], axis=1)

    # Transpose
    coviddata_csse = coviddata_csse.T

    # Index to datetime
    coviddata_csse.index = pd.to_datetime(coviddata_csse.index)

    # Column names to countrynames
    coviddata_csse.columns = coviddata_csse_current["Country/Region"]

    # Countries
    coviddata_csse = coviddata_csse[countries]

    if "France" in countries:
        covid_france = coviddata_csse["France"].sum(axis="columns")
        coviddata_csse = coviddata_csse.drop("France", axis="columns")
        coviddata_csse["France"] = covid_france
    if "US" in countries:
        covid_france = coviddata_csse["US"].sum(axis="columns")
        coviddata_csse = coviddata_csse.drop("US", axis="columns")
        coviddata_csse["US"] = covid_france
    if "China" in countries:
        covid_france = coviddata_csse["China"].sum(axis="columns")
        coviddata_csse = coviddata_csse.drop("China", axis="columns")
        coviddata_csse["China"] = covid_france
    if "Netherlands" in countries:
        covid_france = coviddata_csse["Netherlands"].sum(axis="columns")
        coviddata_csse = coviddata_csse.drop("Netherlands", axis="columns")
        coviddata_csse["Netherlands"] = covid_france
    if "United Kingdom" in countries:
        covid_france = coviddata_csse["United Kingdom"].sum(axis="columns")
        coviddata_csse = coviddata_csse.drop("United Kingdom", axis="columns")
        coviddata_csse["United Kingdom"] = covid_france

    return coviddata_csse
