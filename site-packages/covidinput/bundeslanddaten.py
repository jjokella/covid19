import os
import numpy as np
import pandas as pd
import covidfuncs.dffuncs as cvdff

coviddata_rki = pd.read_csv(
    os.environ['HOME'] + "/covid19/covid-19-germany-gae/cases-rki-by-state.csv",
    sep=',',
)

coviddata_risklayer = pd.read_csv(
    os.environ['HOME'] +
    "/covid19/covid-19-germany-gae/cases-rl-crowdsource-by-state.csv",
    sep=',',
)

bundesland_naming = {
    'Germany': "sum_cases",  #
    'Mecklenburg-Vorpommern': "DE-MV",  #
    'Bremen': "DE-HB",  #
    'Th체ringen': "DE-TH",  #
    'Saarland': "DE-SL",  #
    'Brandenburg': "DE-BB",  #
    'Sachsen-Anhalt': "DE-ST",  #
    'Schleswig-Holstein': "DE-SH",  #
    'Sachsen': "DE-SN",  #
    'Hamburg': "DE-HH",  #
    'Berlin': "DE-BE",  #
    'Hessen': "DE-HE",  #
    'Rheinland-Pfalz': "DE-RP",  #
    'Niedersachsen': "DE-NI",  #
    'Bayern': "DE-BY",  #
    'Baden-W체rttemberg': "DE-BW",  #
    'Nordrhein-Westfalen': "DE-NW"  #
}

def coviddata_bundeslaender(switch="rki"):
    """
    Dataframe with columns for Bundesl채nder and date=-index input from gae repository

    https://github.com/jgehrcke/covid-19-germany-gae

    """

    if switch == "rki":
        coviddata_bundeslaender = coviddata_rki
    elif switch == "rl":
        coviddata_bundeslaender = coviddata_risklayer

    # Rename L채nder from AGS specifier
    for  land, spec  in bundesland_naming.items():

        coviddata_bundeslaender = coviddata_bundeslaender.rename(
            {
                spec: land,
            }, axis=1)

    # Time index handling
    coviddata_bundeslaender.index = pd.to_datetime(
        coviddata_bundeslaender["time_iso8601"].astype(str).str[:-6])
    coviddata_bundeslaender = coviddata_bundeslaender.drop("time_iso8601", axis=1)

    # np.float64 type
    coviddata_bundeslaender = coviddata_bundeslaender.apply(np.float64)

    return coviddata_bundeslaender

    
